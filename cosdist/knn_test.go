package cosdist

import (
	"math/rand"
	"reflect"
	"strconv"
	"testing"
)

var (
	testIDs        = []string{"1", "2", "3", "4", "5"}
	testEmbeddings = [][]float32{
		{0.01873006299138069, -0.0387849435210228, -0.02669272944331169, 0.016450664028525352, -0.04919617250561714, 0.03812594339251518, 0.08314516395330429, -0.05242175608873367, -0.06704669445753098, 0.000660977209918201, -0.01185618806630373, 0.07741489261388779, -0.02038591541349888, -0.03297562152147293, -0.0745231881737709, 0.03430996090173721, 0.03054077923297882, -0.05083144083619118, -0.07440148293972015, 0.02462001144886017, -0.05752846226096153, -0.07561808824539185, -0.05300920456647873, 0.08117005974054337, -0.06341582536697388, 0.0716329887509346, -0.036782752722501755, -0.0431995652616024, 0.05892812833189964, 0.0508209690451622, 0.0722849890589714, 0.007829606533050537, 0.003969916142523289, 0.03851085901260376, -0.04048013687133789, 0.032731976360082626, 0.020182665437459946, -0.071506068110466, -0.004685236141085625, -0.026115883141756058, 0.02848813682794571, -0.0726555734872818, 0.053694114089012146, 0.07961750030517578, -0.021207645535469055, 0.010645446367561817, -0.02699820138514042, 0.07741448283195496, -0.0665484368801117, -0.01760057546198368, 0.013707385398447514, 0.019119800999760628, -0.046694207936525345, 0.08297169208526611, 0.033325694501399994, 0.048975493758916855, 0.0518367625772953, -0.04547867178916931, -0.04194615036249161, 0.03604333847761154, -0.026925023645162582, -0.04102444276213646, 0.06474705785512924, -0.03510072082281113, -0.034298595041036606, -0.03844035044312477, 0.028675271198153496, 0.008776437491178513, 0.00833431538194418, 0.04761144146323204, -0.04772146791219711, -0.049651242792606354, 0.03516509011387825, -0.044524725526571274, 0.038073692470788956, 0.06889259070158005, -0.05665227398276329, -0.005600886419415474, -0.014087319374084473, -0.0024309263098984957, 0.06273458153009415, 0.06771724671125412, 0.009350335225462914, 0.06706634908914566, -0.0429367870092392, -0.0006261435337364674, 0.005468248855322599, -0.028233319520950317, 0.032662343233823776, -0.037607382982969284, 0.05966215953230858, 0.08246531337499619, -0.06840888410806656, -0.02631031535565853, 0.05291467905044556, -0.07034508138895035, 0.06407568603754044, -0.04658942297101021, -0.04311596229672432, -0.016569850966334343, 0.047152210026979446, -0.031161341816186905, -0.04820958524942398, 0.06286600977182388, 0.06379398703575134, 0.0677645280957222, 0.029855230823159218, -0.00658932700753212, 0.048504531383514404, 0.00829977449029684, 0.012273378670215607, -0.0681837722659111, -0.03720006346702576, 0.027391383424401283, -0.05376392975449562, -0.02014641836285591, 0.022898443043231964, -0.03763965517282486, 0.041401199996471405, 0.029464595019817352, -0.02253532037138939, 0.050998445600271225, -0.0458405464887619, 0.04825202375650406, -0.007164884824305773, -0.04310257360339165, -0.044728219509124756, -0.07558216154575348, 0.002373360563069582, -0.07341113686561584, -0.04157215729355812, 0.04620569944381714, -0.0389711819589138, 0.06500692665576935, -0.010691002011299133, -0.020391413941979408, 0.05679287388920784, -0.03861625865101814, 0.0513007827103138, -0.04535022750496864, -0.067813940346241, 0.018829455599188805, -0.06755223125219345, 0.05813765153288841, -0.023352541029453278, 0.017644474282860756, -0.005302858538925648, -0.05740492790937424, 0.07941887527704239, 0.007269744295626879, 0.04761586710810661, -0.0513930544257164, 0.06021962687373161, -0.002023139735683799, 0.0006771734915673733, -0.019313063472509384, -0.020114576444029808, 0.016630273312330246, 0.03842481970787048, -0.018014173954725266, -0.05839502811431885, 0.017999455332756042, 0.028828712180256844, 0.07616402953863144, -0.052479639649391174, -0.06465232372283936, -0.044956307858228683, 0.03688037022948265, 0.006935552693903446, -0.06052185595035553, -0.015958961099386215, -0.011844059452414513, -0.036677949130535126, 0.04096188768744469, -0.000277332408586517, -0.02251097373664379, -0.013428546488285065, 0.05370555818080902, -0.04881512001156807, 0.01167051400989294, -0.06420917063951492, -0.04179207608103752, -0.04637841880321503, 0.028557948768138885, 0.03802076354622841, -0.053819961845874786, 0.031855545938014984, 0.008024652488529682, 0.018472881987690926, 0.00924631953239441, 0.02732088230550289, -0.05038536712527275, -0.05631216615438461, 0.04212018474936485, -0.08065672963857651, -0.03990291431546211, -0.021341998130083084, -0.04411688819527626, 0.044422756880521774, 0.06505060195922852, 0.025372371077537537, -0.00124969775788486, 0.007672583684325218, 0.05523059144616127, 0.0359041653573513, 0.05779782310128212, -0.05347278341650963, -0.003639725036919117, 0.028762128204107285, 0.06333374977111816, 0.02426893636584282, -0.05941688269376755, -0.004995889961719513, -0.0718681663274765, 0.08316411823034286, 0.010694487951695919, 0.017975356429815292, -0.0025921957567334175, 0.06081687659025192, 0.03398820385336876, 0.006634335033595562, 0.009513667784631252, -0.07770156860351562, -0.03984136879444122, 0.01730334386229515, 0.04856714978814125, -0.03535504639148712, -0.010028687305748463, 0.047087717801332474, -0.0354599729180336, 0.028431467711925507, 0.06888099014759064, -0.055819712579250336, -0.02841740846633911, -0.020073862746357918, 0.007266851607710123, -0.00012485696061048657, -0.009542764164507389, -0.009764929302036762, -0.02945827879011631, -0.02753816731274128, -0.018552102148532867, 0.040250442922115326, -0.01763571985065937, -0.05248146504163742, 0.04243503510951996, 0.06565603613853455, 0.054321128875017166, 0.04289040341973305, 0.05828727409243584, -0.011595114134252071, 0.04563787952065468, 0.03281669691205025, -0.08247825503349304, -0.06752604991197586, -0.021754242479801178, -0.026786120608448982, -0.07292928546667099, 0.057643480598926544, 0.037375692278146744, -0.07900433242321014, 0.06982086598873138, 0.04799963906407356, -0.05711107328534126, 0.0777934268116951, -0.0052233487367630005, 0.012006745673716068, 0.03119305521249771, 0.02294120565056801, -0.08147075027227402, -0.04984595254063606, 0.012428873218595982, 0.04090924561023712, -0.04492834955453873, -0.023299390450119972, -0.03346920385956764, -0.03484566509723663, -0.03208967670798302, -0.023414434865117073, 0.00861320085823536, 0.04761478677392006, 0.07443803548812866, -0.02894793078303337, -0.021443389356136322, -0.06984203308820724, -0.020703041926026344, 0.03613933548331261, -0.06584049016237259, -0.03759543597698212, -0.07485740631818771, -0.04231894761323929, 0.04435126483440399, -0.08212925493717194, 0.009253617376089096, 0.054797831922769547, 0.0501403771340847, 0.0042413994669914246, -0.014800924807786942, 0.001788587193004787, -0.07042497396469116, 0.0005526008317247033, 0.015035072341561317, -0.03446933254599571, 0.07203544676303864, -0.05064668878912926, -0.060345932841300964, 0.02069397084414959, 0.050024259835481644, 0.015466365031898022, 0.0009119734750129282, 0.0037810681387782097, 0.03676006570458412, -0.030318988487124443, -0.05936051905155182, 0.06424888223409653, -0.06019715592265129, 0.02384576015174389, -0.01742125302553177, -0.0009097554720938206, -0.04719638079404831, -0.019633743911981583, -0.04782705754041672, 0.07643498480319977, 0.05283190682530403, 0.054211147129535675, 0.07431492209434509, 0.06555604934692383, 0.004571147728711367, -0.022105278447270393, 0.008333265781402588, -0.000981444725766778, -0.03957571089267731, 0.02426222898066044, 0.04620334878563881, -0.005179329309612513, 0.037116121500730515, -0.05176198482513428, 0.04820986092090607, 0.024517351761460304, -0.0757305845618248, 0.022011950612068176, -0.01894933357834816, 0.026290498673915863, 0.06795383989810944, -0.02696024626493454, -0.06374472379684448, 0.0492703840136528, -0.050534531474113464, -0.02684886008501053, -0.004820294678211212, -0.056193239986896515, -0.03601784631609917, -0.022516755387187004, 0.03161739930510521, 0.028357619419693947, -0.0037444322369992733, 0.021533923223614693, -0.011534229852259159, -0.04172491282224655, -0.0014766465174034238, -0.055736709386110306, 0.013427302241325378, -0.0457337461411953, 0.0110210245475173, -0.07469407469034195, 0.03252502903342247, 0.07070959359407425, 0.050185609608888626, 0.04570971801877022, 0.04538410156965256, 0.012542519718408585, 0.03846925497055054, 0.0269260723143816, 0.02636929601430893, -0.017271602526307106, 0.040631361305713654, -0.012748543173074722, -0.03418473154306412, 0.038513414561748505, -0.0752832219004631, -0.03708452731370926, -0.004284972324967384, 0.0325305312871933, 0.028404850512742996, -0.08184404671192169, 0.004437069874256849, 0.017994100227952003, 0.0316101498901844, -0.06961475312709808, 0.03977265954017639, -0.06254719197750092, 0.05457499995827675, 0.03663847595453262, -0.04744100570678711, 0.03302349895238876, 0.053201355040073395, -0.05148979276418686, -0.01478499360382557, -0.04003412276506424, -0.007865090854465961, 0.052225492894649506, -0.056414585560560226, -0.06803742051124573, 0.039734095335006714, -0.0662674680352211, -0.041025083512067795, -0.012487954460084438, -0.007185881491750479, 0.029377542436122894, 0.03631144016981125, 0.07929445803165436, -0.05862107127904892, 0.011998932808637619, 0.01940600574016571, -0.011165507137775421, -0.015433557331562042, -0.03926189988851547, -0.012700366787612438, -0.062162913382053375, 0.0332501158118248, 0.020547451451420784, 0.002229927107691765, 0.022685930132865906, -0.052786312997341156, -0.08055716007947922, -0.03129901736974716, -0.03707157447934151, -0.02663475275039673, -0.04119172692298889, 0.0002357773919356987, 0.05925244092941284, 0.02885911613702774, 0.008312060497701168, 0.057889945805072784, -0.05718526244163513, -0.029984984546899796, 0.032720282673835754, 0.07903710007667542, -0.047584328800439835, -0.04110300913453102, -0.0669662356376648, -0.07954138517379761, -0.033916175365448, -0.07956144213676453, -0.02398485317826271, 0.03782449662685394, 0.07339566200971603, 0.004770501516759396, 0.0462903194129467, 0.028639240190386772, 0.06541027128696442, 0.046255648136138916, 0.03646382316946983, 0.024744492024183273, 0.03891253098845482, -0.044934116303920746, 0.0413382425904274, -0.06169774383306503, 0.007753197103738785, 0.013511396013200283, 0.00965234637260437, 0.05852139741182327, 0.020661137998104095, 0.026964930817484856, 0.012582299299538136, 0.024705201387405396, -0.0247949231415987, -0.04299561306834221, -0.023180095478892326, 0.07095637917518616, 0.059173569083213806, 0.018336301669478416, 0.020474907010793686, 0.009021306410431862, 0.02134932018816471, -0.00035220402060076594, -0.04645292088389397, 0.04507824406027794, 0.04526093974709511, 0.010976697318255901, -0.05903605744242668, 0.03374645486474037, 0.046261757612228394, -0.057032473385334015, -0.04737075790762901, 0.028148354962468147, -0.08235732465982437, 0.0648006722331047, -0.03482166305184364, 0.03113306686282158, -0.019620578736066818, 0.03730804845690727, 0.012166202068328857, -0.05103840306401253, -0.001938585308380425, 0.029029419645667076, -0.06784618645906448, -0.046332474797964096, -0.047222383320331573, 0.050824325531721115, 0.04374191164970398, 0.004646335728466511, -0.04112528637051582, -0.041772764176130295, 0.06353890895843506, -0.022724250331521034, 0.0769721120595932, -0.03392774611711502, 0.04025021195411682, -0.04347337782382965, -0.02906131185591221, 0.020350134000182152},
		{-0.04556586220860481, -0.02462453953921795, -0.0266374833881855, 0.07448083907365799, 0.010228179395198822, -0.03527114540338516, -0.007607443258166313, -0.06964840739965439, -0.03143087401986122, 0.009071187116205692, 0.016029449179768562, -0.04455796629190445, -0.01327549945563078, 0.0068018254823982716, 0.07391971349716187, 0.027335764840245247, -0.016887284815311432, 0.008626649156212807, 0.04947284981608391, -0.01191769540309906, 0.007875066250562668, -0.0565713606774807, -0.04270925745368004, -0.049293868243694305, -0.09283901751041412, 0.016188153997063637, 0.02503686398267746, -0.049093615263700485, -0.039777275174856186, -0.047305021435022354, 0.03408438339829445, 0.06128324568271637, 0.024124469608068466, -0.0015834446530789137, 0.06737025082111359, -0.012813945300877094, 0.055079616606235504, 0.029142022132873535, -0.03787292167544365, 0.03150058910250664, 0.004827705677598715, -0.03298206627368927, 0.0028944669757038355, 0.027938442304730415, -0.05933164060115814, 0.030975015833973885, 0.04923282936215401, 0.003470303723588586, 0.06478852778673172, -0.017055578529834747, -0.038416244089603424, 0.0025343955494463444, 0.05330892279744148, -0.043258585035800934, 0.0494949035346508, 0.032149579375982285, 0.04852105304598808, -0.04644893854856491, -0.04932476207613945, -0.023502452298998833, 0.03363853320479393, -0.018760105594992638, -0.06503178179264069, -0.05960023030638695, -0.018801113590598106, -0.018378864973783493, 0.0337655246257782, 0.07019419223070145, 0.05969003587961197, 0.028904514387249947, 0.060354962944984436, -0.0025421378668397665, 0.009352077730000019, 0.07095322012901306, -0.02769060991704464, 0.054921530187129974, 0.07312773913145065, -0.007803508546203375, 0.014779109507799149, -0.07271511852741241, -0.01936154253780842, 0.025011761114001274, 0.01853584311902523, -0.0143138961866498, -0.0649116113781929, -0.01920350082218647, -0.019446369260549545, -0.0007230268674902618, -0.03680333122611046, -0.05440445989370346, 0.028178270906209946, 0.03258391097187996, 0.010438058525323868, -0.03445173799991608, 0.017840877175331116, -0.013972555287182331, 0.04243313521146774, -0.05201804265379906, 0.030843215063214302, -0.024080613628029823, -0.023894382640719414, -0.011482778005301952, -0.005337554961442947, -0.043230071663856506, -0.051334477961063385, 0.06341607868671417, -0.018855702131986618, 0.003084437921643257, -0.041510697454214096, 0.029339054599404335, -0.007065466605126858, -0.013449444435536861, 0.04011141136288643, 0.08933280408382416, -0.022831900045275688, -0.03623482584953308, -0.009299159981310368, -0.05824724957346916, -0.004635114688426256, -0.07628320157527924, 0.013080460950732231, 0.050263069570064545, 0.025140661746263504, 0.016779417172074318, 0.03862304612994194, -0.009196098893880844, -0.019985850900411606, -0.09245911240577698, -0.06503164023160934, -0.05621302127838135, -0.08774252980947495, -0.0022819084115326405, 0.07391641288995743, 0.05962574481964111, 0.05298701673746109, 0.040039874613285065, -0.08241777867078781, 0.055112384259700775, 0.04250083863735199, -0.01844875141978264, -0.018003782257437706, -0.022479664534330368, -0.0568411648273468, 0.023126667365431786, -0.046210143715143204, -0.06615416705608368, 0.08818703144788742, 0.0006351970951072872, 0.043602749705314636, 0.03206758201122284, 0.054739780724048615, -0.062404461205005646, 0.02890779823064804, 0.06168727949261665, 0.05463101342320442, 0.021739890798926353, -0.05446590110659599, -0.013818246312439442, 0.033502247184515, 0.00131698336917907, -0.04688916727900505, -0.07416121661663055, -0.02764199860394001, -0.016673650592565536, 0.034499116241931915, -0.050065454095602036, -0.021626511588692665, -0.015868553891777992, -0.0014738638419657946, 0.04677802324295044, -0.03302132710814476, 0.08129165321588516, -0.06092870607972145, -0.053025245666503906, 0.002144570928066969, -0.005157687701284885, -0.07200151681900024, -0.017582818865776062, -0.034128252416849136, 0.008172129280865192, 0.010582346469163895, -0.05009379982948303, 0.02059529535472393, -0.03258267790079117, -0.04707775264978409, 0.046402063220739365, 0.019967475906014442, -0.017739813774824142, 0.013174081221222878, 0.04500441998243332, 0.04817868024110794, 0.059943556785583496, -0.001914406311698258, 0.002668374218046665, 0.05107775703072548, -0.050622403621673584, -0.03380335494875908, 0.022258279845118523, -0.010869765654206276, 0.045384883880615234, -0.03529404103755951, 0.011076204478740692, -0.005517072509974241, 0.059829916805028915, 0.040651947259902954, -0.009408906102180481, -0.02935906872153282, -0.02312047965824604, 0.04005927965044975, -0.011921178549528122, 0.043059010058641434, -0.019166575744748116, -0.0191181693226099, 0.011553882621228695, -0.008548892103135586, 0.03602069616317749, -0.038653645664453506, -0.04630143567919731, 0.028468366712331772, 0.024964777752757072, 0.07530141621828079, -0.07632050663232803, -0.014672935009002686, -0.0510183610022068, -0.05937250703573227, -0.026628917083144188, 0.04140253737568855, 0.05266629159450531, 0.07530182600021362, 0.03503274917602539, -0.07894010841846466, 0.00489167170599103, -0.07083427906036377, 0.025225045159459114, -0.05238855630159378, -0.01615799404680729, 0.07038190960884094, -0.06807257235050201, 0.05300334468483925, -0.02297709695994854, 0.058455195277929306, 0.0472262017428875, 0.07268650084733963, 0.02631947584450245, -0.041045740246772766, -0.05228947103023529, 0.008433214388787746, 0.015663208439946175, 0.03212196007370949, -0.01106121763586998, 0.054731033742427826, -0.03681118041276932, -0.029584307223558426, -0.032675597816705704, 0.00827037449926138, 0.0016111305449157953, 0.05456600338220596, 0.02072453871369362, 0.04781246557831764, -0.0623784102499485, -0.07113924622535706, 0.06855524331331253, -0.01647280342876911, 0.042923860251903534, -0.0131887411698699, 0.0389484278857708, -0.01942276395857334, 0.07511455565690994, 0.09441850334405899, 0.00781015120446682, -0.04483248293399811, -0.0034565129317343235, -0.060446847230196, -0.042528603225946426, -0.06683461368083954, 0.020392566919326782, -0.06404637545347214, -0.02134888991713524, 0.03395805507898331, -0.02740669809281826, 0.07376181334257126, 0.005687105935066938, 0.023535391315817833, -0.044089462608098984, -0.056939780712127686, -0.016993222758173943, 0.016972726210951805, 0.04189462214708328, -0.02361569181084633, -0.003931094892323017, -0.028088977560400963, 0.005255959928035736, -0.018625358119606972, 0.032225992530584335, 0.05350007861852646, -0.05275075510144234, -0.02114434726536274, 0.05144232511520386, -0.02327198162674904, -0.05626113712787628, -0.02589046210050583, 0.0254678912460804, -0.023988623172044754, 0.08153124898672104, 0.0040802545845508575, 0.037099439650774, -0.02120167575776577, -0.024163968861103058, -0.0744207575917244, 0.014174595475196838, 0.031863678246736526, 0.017038939520716667, 0.016340138390660286, -0.06657222658395767, -0.032607387751340866, -0.03731687739491463, 0.059296924620866776, -0.04616513475775719, -0.03839903324842453, 0.007236304227262735, -0.06823591142892838, -0.03453893959522247, -0.004705958068370819, -0.006355645600706339, 0.011295611970126629, 0.017925214022397995, 0.07443022727966309, 0.060940925031900406, 0.08841641247272491, -0.04957348480820656, 0.008670364506542683, 0.05848889797925949, -0.009979026392102242, -0.04429252818226814, -0.01581556536257267, 0.025722725316882133, 0.06253639608621597, 0.03555063530802727, 0.032359011471271515, -0.030542561784386635, 0.018900351598858833, 0.0962337777018547, -0.034604985266923904, 0.06543287634849548, -0.035297662019729614, -0.011057408526539803, 0.04579537361860275, 0.03785361349582672, 0.029773637652397156, -0.07199329882860184, 0.03274138271808624, 0.07165195792913437, -0.054234106093645096, 0.07239292562007904, 0.05799560248851776, 0.04225390404462814, -0.046966712921857834, -0.047366365790367126, -0.016425862908363342, -0.010624350979924202, -0.009172736667096615, -0.007647993974387646, -0.019245019182562828, 0.027860406786203384, 0.06613002717494965, 0.007579052355140448, -0.04221629351377487, 0.07014279812574387, 0.031092237681150436, 0.05272866040468216, -0.017419178038835526, 0.02027089148759842, 0.043948154896497726, -0.05459226667881012, -0.03111920692026615, 0.044764213263988495, -0.05334561690688133, 0.08300027996301651, -0.030551623553037643, 0.03143831714987755, 0.03159720078110695, 0.05237177386879921, 0.06751473248004913, -0.06022496148943901, 0.013736972585320473, -0.07759422808885574, 0.025604605674743652, -0.05437130108475685, -0.08329567313194275, -0.016475919634103775, -0.028102263808250427, -0.007799908053129911, -0.016307326033711433, 0.0006625085370615125, -0.033662039786577225, 0.08512206375598907, 0.031185658648610115, 0.02526826597750187, 0.049465078860521317, -0.023030051961541176, 0.051787905395030975, 0.004505114164203405, -0.09379809349775314, -0.05683986470103264, -0.04863757640123367, 0.00149631523527205, -0.08147692680358887, -0.02914281375706196, 0.00043500858009792864, 0.0844130590558052, 0.030106177553534508, 0.012566182762384415, -0.006520648021250963, -0.01640954241156578, 0.017644353210926056, 0.07530365139245987, 0.09138483554124832, 0.04987554997205734, 0.06798972189426422, -0.027377238497138023, 0.020759453997015953, 0.017448244616389275, -0.03710747882723808, -0.04910711571574211, -0.09354227781295776, -0.030806729570031166, 0.08512116223573685, -0.06432870030403137, 0.027306150645017624, 0.04950706660747528, 0.046117689460515976, -0.004186534788459539, 0.07807845622301102, -0.08848008513450623, -0.029107069596648216, 0.04973335564136505, -0.024461517110466957, -0.008269733749330044, -0.05393386632204056, -0.08594078570604324, 0.018260547891259193, -0.08129485696554184, -0.01837983913719654, 0.08366287499666214, 0.07761052995920181, -0.03878500685095787, 0.025334494188427925, 0.006943731103092432, 0.03976820036768913, 0.010979313403367996, 0.015024257823824883, 0.01492615882307291, -0.021082524210214615, 0.023041607812047005, -0.04704663157463074, -0.0601593479514122, 0.03741533309221268, -0.0009351068874821067, 0.019557757303118706, -0.06377711147069931, -0.015049072913825512, 0.02643159031867981, -0.02635185234248638, 0.08168879896402359, 0.10060153156518936, 0.0479065477848053, 0.004160640295594931, 0.04114718735218048, -0.004677876830101013, -0.013797963969409466, -0.035341423004865646, -0.01325985323637724, -0.009279663674533367, 0.004857358522713184, 0.0007966364501044154, 0.05554765462875366, -0.05572889372706413, 0.01817811094224453, -0.049052778631448746, 0.0065971980802714825, -0.008634327910840511, -0.012765751220285892, 0.032903436571359634, -0.08714639395475388, -0.07833874225616455, 0.08028797060251236, 0.012133811600506306, 0.030742222443223, -0.04740521311759949, -0.05709771439433098, -0.00038700419827364385, -0.05658254772424698, -0.08490954339504242, -0.008292432874441147, 0.03633164241909981, -0.04387892782688141, 0.0037701984401792288, 0.0037445940542966127, 0.020935216918587685, 0.029596051201224327, 0.045212190598249435, -0.0016645913710817695, -0.04837493225932121, 0.08505833148956299, 0.022641323506832123, -0.014816968701779842, 0.08745156228542328, -0.03956148028373718, 0.05905764922499657, -0.0021186424419283867, -0.05633482336997986, 0.03828126937150955},
		{0.0685848668217659, -0.03500690311193466, -0.017080890014767647, 0.01461410615593195, -0.028970586135983467, -0.06019613891839981, 0.033927928656339645, -0.06207042187452316, -0.058468788862228394, -0.018233073875308037, 0.07126273214817047, 0.06676018238067627, 0.007301604375243187, 0.02891727350652218, 0.05299684405326843, -0.0568644180893898, 0.06479556113481522, 0.035985708236694336, 0.053718388080596924, -0.00964448507875204, 0.05657602846622467, -0.06304655224084854, 0.0023510886821895838, 0.04848461225628853, -0.051141347736120224, 0.0016376159619539976, -0.03419797867536545, -0.00740811787545681, 0.010185846127569675, 0.07157662510871887, -0.04083569720387459, 0.027144255116581917, 0.005240611266344786, 0.02481980063021183, 0.001245531952008605, -0.010609793476760387, 0.04628166928887367, -0.0625620186328888, -0.08045932650566101, -0.02605055831372738, -0.030055509880185127, -0.07991291582584381, -0.00871754065155983, 0.06703980267047882, 0.06259122490882874, 0.030138961970806122, 0.07072438299655914, -0.07499225437641144, -0.08274208009243011, -0.06004814803600311, -0.02626403048634529, -0.010256431996822357, -0.03909970447421074, -0.002892541466280818, 0.034683842211961746, 0.07208292931318283, 0.0360521525144577, 0.042041484266519547, 0.06034433841705322, 0.059774287045001984, 0.04928077012300491, -0.016343966126441956, 0.0069089182652533054, 0.006815512198954821, 0.03183673322200775, -0.012540757656097412, 0.0042519825510680676, 0.053553856909275055, 0.017292318865656853, 0.04885447025299072, -0.018415730446577072, 0.0626266598701477, -0.014818187803030014, 0.007806409150362015, -0.060208480805158615, 0.02456696890294552, 0.03451826423406601, -0.04781286418437958, 0.03341209143400192, 0.005173018202185631, 0.027740832418203354, 0.0564945787191391, 0.06206929683685303, 0.006051462143659592, 0.013173121958971024, -0.018666883930563927, 0.0512346550822258, -0.0072858138009905815, 0.01248688343912363, -0.04904253035783768, 0.04087728261947632, 0.017159568145871162, 0.06202651932835579, 0.0818326324224472, -0.022664299234747887, 0.032756347209215164, 0.06587318331003189, -0.07354453206062317, -0.050331100821495056, 0.07102935761213303, 0.05007847398519516, -0.02693735435605049, 0.0548681914806366, 0.013351580128073692, 0.02615983970463276, 0.04896707087755203, 0.020388547331094742, 0.029029056429862976, -0.0333380363881588, -0.05739925056695938, 0.03541538491845131, -0.04225509986281395, -0.02896902523934841, 0.03818302974104881, -0.04323283210396767, -0.0015873913653194904, -0.022256264463067055, -0.04153774678707123, 0.04420917108654976, 0.018928956240415573, 0.016849994659423828, -0.05364065617322922, -0.059092212468385696, 0.019740592688322067, 0.023758720606565475, -0.01704278215765953, 0.022427743300795555, -0.0031665379647165537, -0.009031806141138077, 0.03180956467986107, -0.07958254218101501, -0.021709904074668884, 0.057345736771821976, -0.03286081552505493, -0.06985493004322052, -0.07750730216503143, -0.010137917473912239, -0.017098085954785347, 0.03320333734154701, -0.06719337403774261, 0.042533792555332184, -0.003726246766746044, -0.052790362387895584, -0.00922905933111906, -0.001782907173037529, -0.032683853060007095, -0.05235975235700607, 0.009173071011900902, 0.007566857151687145, 0.05775392800569534, 0.07306001335382462, -0.04480896145105362, -0.032462600618600845, 0.017135173082351685, -0.039536554366350174, 0.021517060697078705, 0.06987189501523972, 0.044679250568151474, -0.01684548519551754, 0.028911475092172623, 0.007656367029994726, 0.028874222189188004, -0.010681942105293274, 0.07109850645065308, 0.0682331919670105, 0.027083057910203934, -0.05206165835261345, -0.004194656386971474, 0.06409413367509842, -0.008412863127887249, 0.0631822720170021, -0.04294222220778465, 0.08210083842277527, 0.02221551537513733, 0.008338226936757565, 0.08037540316581726, 0.006406382657587528, 0.05312064662575722, -0.0057693407870829105, -0.005628532264381647, -0.0032968635205179453, -0.05253016576170921, 0.040225666016340256, -0.04188206046819687, -0.04885747283697128, -0.018499672412872314, -0.03580012544989586, 0.022718176245689392, 0.0472177229821682, 0.03536645695567131, -0.025743834674358368, -0.017379628494381905, -0.025446604937314987, 0.006754102185368538, 0.03497273474931717, -0.006366437301039696, 0.005566298961639404, 0.03145463019609451, 0.025324080139398575, 0.0015169925754889846, -0.06858373433351517, 0.0685243085026741, 0.020373815670609474, 0.08090415596961975, 0.05615990236401558, -0.052726585417985916, 0.024664809927344322, -0.011836572550237179, 0.05820593610405922, 0.043754253536462784, -0.014797820709645748, -0.06459371745586395, 0.033907920122146606, -0.015601684339344501, 0.038812823593616486, 0.056941594928503036, -0.025178993120789528, -0.055363621562719345, 0.011163276620209217, -0.03149067610502243, -0.004661966115236282, 0.021004604175686836, 0.02140951156616211, -0.03960130736231804, -0.0721283033490181, 0.01566893234848976, 0.041447099298238754, -0.006392877548933029, 0.0010035205632448196, 0.011328806169331074, -0.02945386990904808, -0.04519405588507652, 0.06318677961826324, -0.06639961898326874, 0.029852023348212242, -0.021092146635055542, -0.042823418974876404, -0.016565995290875435, -0.07945366203784943, -0.035468049347400665, -0.03356747701764107, -0.055715009570121765, -0.06512618064880371, -0.033342115581035614, 0.07290951907634735, -0.010759794153273106, -0.01959182508289814, -0.058987632393836975, -0.01837325468659401, 0.0359378345310688, -0.052616458386182785, 0.017839955165982246, -0.01991904526948929, -0.035210683941841125, 0.0028234233614057302, 0.03123266063630581, -0.056664299219846725, -0.05229605734348297, -0.009800983592867851, 0.012911370024085045, -0.023706603795289993, -0.04729846492409706, -0.04610595852136612, 0.06324821710586548, 0.031239984557032585, 0.03029984049499035, -0.057762254029512405, 0.024317078292369843, 0.02131606824696064, -0.05417098104953766, -0.04931665584445, 0.0011213953839614987, 0.0712747573852539, -0.03117864765226841, -0.07360373437404633, -0.04584676772356033, -0.008336368016898632, 0.05342410132288933, -0.01755521632730961, 0.04759076237678528, 0.032699525356292725, -0.04696714133024216, -0.025283074006438255, -0.03445368632674217, -0.07764501869678497, 0.05074812471866608, -0.016734423115849495, 0.007439862005412579, 0.016335103660821915, 0.06750913709402084, -0.02797538973391056, 0.015224093571305275, -0.006328202784061432, 0.026492640376091003, -0.05907745659351349, -0.0148396585136652, -0.02622869797050953, 0.03912537544965744, 0.0420132577419281, -0.04355550929903984, -0.059573013335466385, 0.02457611821591854, -0.0275814700871706, 0.07441806048154831, -0.06774033606052399, -0.009875640273094177, 0.01799500733613968, -0.028527483344078064, -0.048267919570207596, 0.07006321102380753, 0.07019910216331482, 0.01505399402230978, -0.012077235616743565, -0.06151987612247467, -0.03564789518713951, 0.04643639922142029, -0.002997160656377673, 0.024651948362588882, 0.05116827040910721, -0.08142532408237457, 0.06541383266448975, 0.0101883290335536, -0.03902304545044899, 0.04782284051179886, 0.007975900545716286, 0.07913753390312195, -0.019749552011489868, 0.02160441130399704, 0.04979909211397171, 0.06791882961988449, 0.07207288593053818, 0.06166016310453415, 0.029300469905138016, -0.07573114335536957, 0.0020389368291944265, 0.06776455789804459, -0.004396062809973955, -0.012455473653972149, -0.08103563636541367, -0.06790409982204437, 0.07339377701282501, 0.029690638184547424, -0.011851809918880463, 0.06505319476127625, -0.06756800413131714, -0.07990419864654541, -0.008662334643304348, -0.05835668370127678, 0.048260439187288284, -0.006636425852775574, 0.05910597741603851, 0.04610962048172951, 0.06366729736328125, 0.030258914455771446, 0.05001038685441017, -0.04668309539556503, -0.06841788440942764, -0.05194461718201637, 0.06350096315145493, 0.007293187081813812, 0.032641686499118805, -0.005902106408029795, 0.06938212364912033, 0.05572262778878212, 0.03915047645568848, 0.05542052909731865, 0.05972135812044144, 0.054310958832502365, 0.038278549909591675, -0.06142530217766762, -0.02433268167078495, 0.07294222712516785, -0.06324949115514755, -0.07556518167257309, -0.04435411095619202, -0.004458355251699686, -0.020051319152116776, -0.05480877310037613, -0.0288835596293211, -0.06943227350711823, -0.006303243339061737, 0.020267432555556297, 0.04778295010328293, 0.0805363804101944, -0.04258998855948448, -0.04350093752145767, -0.021128155291080475, 0.058124713599681854, -0.07304856926202774, 0.02848276123404503, 0.002166271675378084, 0.00178959546610713, -0.023980040103197098, 0.01554927695542574, 0.08050640672445297, 0.02711697295308113, 0.004931995179504156, 0.003569827415049076, 0.039973173290491104, -0.028960634022951126, 0.058635562658309937, -0.005239779595285654, -0.06507731229066849, -0.005850447807461023, -0.036910250782966614, -0.0414472334086895, 0.052935466170310974, 0.0005010033491998911, -0.02986549772322178, -0.029361015185713768, 0.0207607913762331, 0.06247791647911072, -0.018104441463947296, 0.07067698985338211, -0.013947447761893272, 0.06282331049442291, 0.024471109732985497, 0.040317799896001816, -0.0038449857383966446, 0.039662834256887436, 0.018788937479257584, -0.0023926151916384697, -0.03398653119802475, -0.04379739239811897, 0.055010534822940826, -0.013982024975121021, -0.03659432381391525, 0.0388735756278038, -0.048023901879787445, 0.037650078535079956, 0.0523967482149601, 0.013275119476020336, -0.04382922872900963, -0.050146814435720444, -0.05414608493447304, 0.06515517085790634, -0.0007568175788037479, -0.05387788638472557, -0.06923357397317886, -0.047417137771844864, 0.015311387367546558, -0.07427500188350677, 0.07756835222244263, 0.020177435129880905, 0.030710922554135323, -0.016883159056305885, -0.054157812148332596, 0.06351391971111298, 0.02880186401307583, -6.936593854334205e-05, 0.07760189473628998, 0.07652050256729126, 0.0018730821320787072, -0.0653400719165802, 0.029413476586341858, -0.004232292994856834, 0.031229883432388306, 0.05565773323178291, -0.00824353750795126, 0.04963983967900276, 0.018583064898848534, -0.045496903359889984, 0.07219718396663666, 0.02246650867164135, -0.03076935186982155, -0.004806132055819035, 0.06360583007335663, -0.0803934633731842, -0.04844324663281441, 0.04346738010644913, 0.03472670167684555, -0.02436109073460102, -0.06448536366224289, 0.01724209450185299, 0.007283887825906277, -0.014965741895139217, 0.004311561118811369, 0.047438234090805054, 0.07151321321725845, 0.026410309597849846, 0.0727638229727745, 0.036488283425569534, -0.03560706228017807, 0.02876276709139347, -0.04050246998667717, -0.05453421175479889, 0.0577751025557518, 0.058896806091070175, -0.007684918120503426, -0.019713379442691803, -0.03633056953549385, 0.02457316592335701, -0.019254019483923912, 0.0685877799987793, 0.07022006064653397, 0.027434250339865685, -0.07172122597694397, 0.026830218732357025, -0.05813334137201309, -0.07340383529663086, -0.04929801821708679, 0.033304620534181595, -0.0005914312205277383, -0.016060786321759224, -0.006793507374823093, -0.03953423351049423, 0.07031214237213135, -0.07081388682126999, 0.020623456686735153, 0.025953341275453568, -0.020423000678420067, -0.06677976995706558},
		{0.004680979996919632, -0.07080525904893875, -0.06100898236036301, 0.02438288927078247, -0.048361361026763916, -0.07111749053001404, 0.011539168655872345, 0.0052215466275811195, -0.0640297532081604, -0.08183992654085159, 0.06193038448691368, -0.018172500655055046, 0.00923600047826767, -0.033012114465236664, -0.10071828216314316, 0.043745726346969604, 0.02408338524401188, 0.03027716837823391, -0.0669131726026535, -0.036922257393598557, 0.0941300094127655, -0.030027735978364944, -0.09018925577402115, 0.019328201189637184, 0.03547899052500725, -0.008627612143754959, -0.08192620426416397, -0.03190436214208603, -0.06937702745199203, -0.056394316256046295, 0.019791051745414734, 0.0052985441870987415, 0.05955467000603676, 0.028837695717811584, 0.07287942618131638, 0.043492455035448074, 0.0839371383190155, -0.04409792646765709, -0.05468849465250969, 0.0010493649169802666, -0.07333437353372574, -0.0017941273981705308, -0.00449323421344161, 0.060601089149713516, -0.0018732157768681645, 0.05231828987598419, -0.012923283502459526, -0.05822298675775528, -0.03009047359228134, -0.08545510470867157, -0.06980647891759872, 0.03823301941156387, 0.003421439090743661, 0.018614865839481354, 0.03756394237279892, -0.00013593336916528642, 0.033965107053518295, -0.0582311749458313, 0.08509562164545059, -0.0016353769460693002, -0.06365275382995605, -0.015825951471924782, -0.06615173071622849, -0.0033194441348314285, -0.06242583319544792, -0.08620569854974747, 0.009035887196660042, -0.043273575603961945, -0.0012750955065712333, -0.0361957848072052, 0.006410354748368263, -0.022489026188850403, -0.06338615715503693, 0.00829283706843853, 0.03549720719456673, -0.06340993195772171, -0.015557878650724888, 0.06407980620861053, -0.0290130116045475, -0.03293003886938095, 0.0762546956539154, 0.022660791873931885, 0.03914060816168785, 0.054373569786548615, -0.06554293632507324, 0.007934206165373325, 0.0051053427159786224, 0.009728915058076382, 0.025678925216197968, -0.014081879518926144, 0.0555693656206131, 0.0077535840682685375, -0.0937858447432518, -0.002028799382969737, -0.03751420974731445, -0.008399388752877712, -0.020270608365535736, -0.018164845183491707, 0.004016573540866375, 0.011991315521299839, -0.036046892404556274, -0.07606916129589081, -0.04899238795042038, -0.015484201721847057, -0.010525482706725597, 0.00399734964594245, 0.09018844366073608, 0.012271835468709469, 0.02224646508693695, 0.03584778681397438, 0.0278971828520298, -0.003618397284299135, 0.04956968128681183, 0.008070106618106365, -0.06881826370954514, 0.026432238519191742, 0.06187690421938896, -0.022758763283491135, 0.08252805471420288, 0.05422162264585495, -0.04210560396313667, -0.0757276862859726, 0.08010212332010269, 0.03826873376965523, 0.04543327912688255, -0.04308222979307175, -0.006261626724153757, -0.031618859618902206, 0.04000062122941017, 0.048011161386966705, 0.04313308745622635, 0.034808091819286346, -0.014212890528142452, 0.008849582634866238, 0.015881523489952087, 0.0097435237839818, 0.025217527523636818, -0.015287979505956173, 0.03081914596259594, 0.044921424239873886, -0.026112088933587074, 0.026344481855630875, -0.05310691520571709, 0.05797705054283142, 0.013918189331889153, 0.019294455647468567, 0.03311976417899132, 0.035465553402900696, -0.03411339968442917, 0.07042405009269714, -0.02054654434323311, -0.03740713372826576, 0.03904290497303009, -0.06994892656803131, 0.017313838005065918, -0.0027477566618472338, -0.005619434639811516, 0.03443474695086479, -0.005428534932434559, 0.014047891832888126, -0.04548506438732147, 0.02182202786207199, -0.005768593400716782, 0.05416503921151161, -0.05646278336644173, -0.013191773556172848, 0.06906042248010635, 0.020886404439806938, -0.03999325633049011, -0.07441086322069168, 0.012889881618320942, -0.046306706964969635, -0.004682349506765604, 0.02199854515492916, 0.0006387302419170737, 0.039678025990724564, -0.001037015113979578, 0.035991981625556946, -0.027936702594161034, -0.02620055340230465, -0.03213031217455864, 0.041005637496709824, 0.018817637115716934, 0.0056733740493655205, 0.024949505925178528, 0.039822835475206375, -0.007735683582723141, -0.014765516854822636, -0.024675900116562843, 0.0041319215670228004, -0.023666562512516975, 0.04984282702207565, -0.0477541908621788, -0.009603872895240784, 0.008164254017174244, -0.037828270345926285, 0.04277802258729935, -0.037420596927404404, 0.02119229920208454, 0.05267572030425072, -0.08208335191011429, 0.006987952161580324, 0.07830813527107239, 0.005458802450448275, 0.032119203358888626, 0.07859929651021957, -0.04254082962870598, -0.014604992233216763, 0.030081303790211678, 0.034174058586359024, 0.016518225893378258, -0.015933364629745483, 0.0743243396282196, -0.07896679639816284, 0.024493299424648285, -0.09943219274282455, -0.07133620232343674, 0.03077991120517254, 0.04266957938671112, -0.0021892955992370844, 0.047648463398218155, -0.06408867985010147, -0.1002277284860611, 0.05029686167836189, -0.025428486987948418, 0.0034804795868694782, 0.060605768114328384, 0.054508987814188004, 0.022169213742017746, 0.020633967593312263, -0.014141899533569813, -0.05114401876926422, 0.023991459980607033, 0.04728594049811363, 0.013321098871529102, 0.0601176843047142, -0.011542550288140774, 0.08782501518726349, -0.03792544826865196, 0.043379947543144226, 0.006586798001080751, -0.0074600582011044025, -0.024187149479985237, -0.04665069282054901, -0.031301531940698624, 0.018698126077651978, -0.02863166853785515, -0.08601284772157669, -0.0617368184030056, -0.06935807317495346, 0.08278286457061768, -0.04515080153942108, -0.05192156881093979, -0.019578896462917328, 0.013018655590713024, -0.013419277966022491, 0.03454175963997841, -0.059850726276636124, 0.022729363292455673, -0.032990917563438416, -0.04251287877559662, -0.009519308805465698, -0.0026960673276335, -0.02991820126771927, -0.032316021621227264, -0.03690153732895851, 0.03251178562641144, -0.010771697387099266, 0.0047729904763400555, -0.03584384545683861, -0.0035109492018818855, -0.023055780678987503, -0.06675238907337189, 0.07173763960599899, -0.08630670607089996, -0.008320529945194721, -0.02135574258863926, -0.03032841719686985, 0.06356538832187653, -0.007202786393463612, -0.07245638221502304, -0.030929792672395706, -0.04172990098595619, 0.014542779885232449, -0.041221968829631805, 0.03196609765291214, -0.032023847103118896, 0.01891392283141613, 0.050682924687862396, -0.011563240550458431, -0.055435530841350555, -0.038856666535139084, -0.0007538719801232219, -0.041655827313661575, -0.061063095927238464, -0.016375049948692322, 0.04454406723380089, -0.0024767383001744747, -0.03744306042790413, 0.04110655561089516, -0.023365411907434464, 0.006352266296744347, -0.05375244468450546, -0.048977915197610855, 0.0690893679857254, 0.055351126939058304, -0.051089245826005936, -0.04444590583443642, 0.0020706127397716045, 0.03127231448888779, 0.033268868923187256, 0.07826767861843109, 0.006911891046911478, -0.030391057953238487, 0.017123840749263763, 0.010724511928856373, 0.04189956560730934, 0.029984137043356895, 0.04121677577495575, -0.034643784165382385, -0.03160945698618889, -0.007354719564318657, 0.08945956081151962, -0.021981211379170418, 0.001480482635088265, -0.008259479887783527, -0.006826415657997131, -0.06132078915834427, 0.008394470438361168, 0.045741286128759384, -0.06048831716179848, -0.05714534595608711, -0.012167030945420265, 0.051420826464891434, -0.02097366936504841, -0.0175724346190691, -0.0073988186195492744, 0.028169060125947, -0.050704579800367355, -0.004247560165822506, 0.026851417496800423, 0.0107653783634305, 0.05941924452781677, 0.03046666644513607, -0.05775437131524086, -0.006976227276027203, -0.02603239007294178, 0.06456535309553146, 0.018645551055669785, 0.04273424297571182, -0.05717784911394119, 0.07158420979976654, 0.0008330601267516613, 0.030645407736301422, -0.05012531951069832, 0.09144997596740723, 0.02745477855205536, 0.07345220446586609, -0.005651699844747782, -0.0503644235432148, -0.009274939075112343, 0.028579823672771454, 0.05977777764201164, -0.03900663182139397, -0.08775627613067627, 0.058671750128269196, 0.011390465311706066, 0.03999951854348183, 0.013423102907836437, 0.014914457686245441, -0.008012664504349232, -0.053289107978343964, 0.06610006093978882, 0.008641336113214493, -0.03485177084803581, 0.03075052797794342, -0.0009195221937261522, 0.009019384160637856, 0.01383803691715002, 0.03474472463130951, 0.04569421336054802, 0.03656696900725365, -0.03640443831682205, 0.022850720211863518, -0.06096259504556656, -0.001057985471561551, -0.001997441751882434, 0.0352226160466671, -0.07837134599685669, -0.03433147817850113, -0.024736855179071426, -0.040562693029642105, -0.03776409476995468, 0.049934931099414825, -0.033699896186590195, -0.05925780162215233, -0.04012506827712059, 0.010702674277126789, 0.04824104905128479, 0.013289099559187889, 0.05524758622050285, 0.08746285736560822, 0.0253661647439003, -0.0010174040216952562, 0.02625091001391411, -0.09103678166866302, 0.045175522565841675, -0.06905572861433029, -0.08051729947328568, 0.07460829615592957, 0.06495081633329391, -0.028161460533738136, -0.020367354154586792, -0.018057072535157204, 0.04150039702653885, 0.04279632493853569, 0.0343349389731884, -0.0338139608502388, -0.03278927505016327, 0.07764489203691483, 0.026929883286356926, -0.007951040752232075, 0.06071799620985985, -0.04269741103053093, -0.10209726542234421, 0.06374383717775345, 0.07636746019124985, 0.046949807554483414, -0.06454071402549744, -0.051911380141973495, 0.04962150752544403, -0.019602136686444283, -0.043250855058431625, 0.07395608723163605, 0.0065409536473453045, -0.05002070963382721, -0.01853918842971325, 0.026762595400214195, 0.0857217013835907, -0.04351983964443207, 0.08462074398994446, -0.002960552228614688, -0.022187283262610435, 0.025072293356060982, -0.07722705602645874, 0.055523768067359924, -0.015517950057983398, 0.06710781902074814, 0.03612601011991501, 0.05680987983942032, 0.034027181565761566, 0.0574464276432991, 0.03630128875374794, 0.0662868320941925, 0.023372648283839226, 0.011036784388124943, 0.05452684685587883, -0.04472867771983147, -0.06222962960600853, -0.00027615847648121417, -0.04339144378900528, -0.03303394094109535, -0.04052221029996872, 0.07201949506998062, 0.05441403388977051, -0.005807872861623764, -0.006913241930305958, 0.010838214308023453, -0.04671947658061981, -0.06126461178064346, 0.018236052244901657, -0.03572872281074524, -0.01759459264576435, 0.08175487071275711, 0.07326021045446396, 0.014602713286876678, -0.026611745357513428, 0.004343436565250158, -0.03135634958744049, -0.020794184878468513, -0.06250113248825073, 0.0202101469039917, 0.011134299449622631, 0.06506014615297318, 0.06725329160690308, 0.021505462005734444, -0.02628811076283455, 0.07017530500888824, -0.020499901846051216, -0.04379366338253021, -0.037152260541915894, -0.033988263458013535, -0.044539403170347214, 0.02885114587843418, 0.008881282061338425, 0.06031510606408119, 0.0400640033185482, -0.03836321458220482, 0.003590762848034501, -0.020919062197208405, -0.058367982506752014, -0.07792580127716064, 0.04168934375047684, -0.00669429125264287, -0.005113729275763035, -0.02547527849674225, -0.024207456037402153, -0.0425071157515049, 0.0299344751983881, -0.05626273527741432, 0.00461768452078104, -0.031126199290156364},
		{0.022808503359556198, -0.06460483372211456, -0.03199833631515503, 0.016832970082759857, 0.0008840581285767257, 0.005135401617735624, 0.06962602585554123, 0.04650387912988663, -0.05775292217731476, 0.03477368876338005, -0.058279864490032196, 0.03273241966962814, 0.04528069123625755, 0.05805385485291481, -0.07528910040855408, -0.0022369513753801584, 0.014416554942727089, -0.05611996352672577, -0.012459521181881428, -0.006791994441300631, -0.036253251135349274, -0.07913335412740707, -0.027441414073109627, -0.012118649668991566, 0.061412882059812546, -0.023092202842235565, 0.033884402364492416, -0.0747450441122055, -0.014938645996153355, 0.01404564455151558, -0.0313451811671257, -0.005358127411454916, 0.03418876230716705, 0.014451365917921066, -0.005064434837549925, -0.02976292185485363, -0.040550172328948975, -0.010826123878359795, 0.029974520206451416, 0.0780397430062294, 0.0154793756082654, 0.02203495055437088, -0.0021804668940603733, -0.05742383375763893, -0.012556162662804127, 0.07056945562362671, 0.050604626536369324, 0.06000978499650955, -0.07942789047956467, 0.033013034611940384, 0.015529691241681576, 0.033953651785850525, -0.02125454880297184, 0.051133979111909866, 0.06409438699483871, 0.04633867368102074, 0.0784534215927124, -0.0032220142893493176, 0.017212141305208206, -0.03130488097667694, 0.050570204854011536, -0.05946777015924454, -0.008021339774131775, -0.004142639227211475, 0.05389179661870003, -0.05899235978722572, 0.03309573978185654, 0.03818875551223755, -0.06809283792972565, 0.022220918908715248, 0.06865135580301285, 0.017950618639588356, -0.032598383724689484, -0.03858477994799614, 0.0351690873503685, 0.02262907847762108, 0.007552264723926783, -0.02193610742688179, -0.027225837111473083, 0.04763163626194, 0.014121799729764462, 0.05941079184412956, -0.03635503724217415, 0.04030807316303253, 0.035115811973810196, -0.022646687924861908, -0.07096624374389648, -0.04307376220822334, 0.04995841160416603, -0.07562129199504852, 0.07919847220182419, 0.023340903222560883, -0.06988923251628876, 0.06934385746717453, -0.026698913425207138, -0.019081732258200645, -0.009243227541446686, -0.0741250142455101, 0.07696732133626938, 0.07374852150678635, -0.05624718964099884, -0.03799312561750412, -0.01051511149853468, -0.03422249108552933, 0.011568862944841385, -0.043396007269620895, -0.02663533017039299, -0.03178995102643967, -0.04998090863227844, 0.01206477265805006, 0.018033400177955627, 0.043573182076215744, -0.04291399195790291, -0.05039490386843681, -0.051979005336761475, 0.009770556353032589, -0.020840387791395187, -0.07771075516939163, 0.019402695819735527, 0.02456369251012802, -0.055522620677948, -0.04607788845896721, -0.037734344601631165, 0.036881111562252045, -0.008765734732151031, -0.01909392513334751, -0.04195713251829147, 0.014080651104450226, -0.004813802894204855, -0.05779925733804703, 0.036691710352897644, 0.00011705319047905505, 0.03434816002845764, -0.020891420543193817, -0.05507281795144081, 0.055867042392492294, -0.06180620938539505, -0.00790434330701828, 0.07780985534191132, 0.058233555406332016, 0.06412165611982346, 0.04440988600254059, -0.07426166534423828, 0.03741646930575371, -0.010820126160979271, -0.007433856371790171, 0.030739277601242065, -0.013587757013738155, 0.06340920180082321, -0.008863940834999084, -0.02832643873989582, -0.061737336218357086, 0.04949767142534256, 0.060589976608753204, -0.005408736411482096, 0.03339437395334244, 0.02877236343920231, -0.003809811547398567, -0.03372618183493614, -0.005206190049648285, -0.07287631183862686, -0.04341217130422592, -0.0396832600235939, -0.01163481641560793, -0.031997282058000565, -0.030138740316033363, -0.003488224698230624, -0.044498901814222336, 0.060576844960451126, 0.05609043315052986, 0.0744495689868927, 0.06506802886724472, 0.05220629274845123, 0.05269426107406616, 0.037500739097595215, -0.04020119458436966, -0.009306764230132103, -0.05725056305527687, -0.06838608533143997, 0.05006660893559456, -0.03513730689883232, -0.009157530032098293, -0.01491548027843237, 0.05464664101600647, 0.016195226460695267, 0.012335294857621193, 0.0261559896171093, 0.04877344146370888, 0.028061991557478905, -0.04476798325777054, 0.05212324112653732, -0.01153920404613018, -0.06290159374475479, -0.0780446007847786, -0.008637002669274807, -0.05032219737768173, 0.07822868973016739, -0.04234624654054642, -0.0023296091239899397, -0.007744566071778536, -0.03975149989128113, -0.039404675364494324, 0.06990588456392288, 0.021298343315720558, 0.04478896036744118, -0.05790111795067787, 0.027914011850953102, 0.04834877327084541, 0.056516822427511215, 0.04156268760561943, 0.07171185314655304, -0.003789900103583932, 0.03835833817720413, 0.004131602123379707, -0.02488894946873188, -0.05727556720376015, -0.008539312519133091, -0.07098539918661118, 0.07327287644147873, -0.049166642129421234, -0.027578864246606827, 0.03180667757987976, 0.0168287493288517, -0.03319147974252701, -0.04447047412395477, -0.07107152789831161, -0.029523082077503204, 0.049986694008111954, -0.0628272145986557, -0.06113381311297417, 0.001441147644072771, 0.05412709712982178, 0.06389828026294708, 0.06036272644996643, -0.07191380858421326, -0.020590683445334435, 0.01121462695300579, 0.012482348829507828, -0.0008081796113401651, -0.0035485466942191124, -0.04790321737527847, -0.0755368173122406, -0.054972052574157715, -0.0028580399230122566, -0.0038229364436119795, -0.010854803025722504, 0.0006591411656700075, -0.027255939319729805, 0.011617588810622692, 0.026134176179766655, 0.04502936452627182, -0.07226153463125229, 0.003551628440618515, -0.048949502408504486, 0.02791256457567215, 0.020464379340410233, 0.024627745151519775, -0.068914495408535, 0.007240891456604004, -0.0030794532503932714, 0.0444055013358593, -0.059464436024427414, -0.039822064340114594, -0.039822012186050415, 0.0778733566403389, -0.07862831652164459, -0.07520730048418045, -0.05698191002011299, 0.015382242389023304, 0.034288663417100906, -0.022865472361445427, 0.005907172802835703, -0.025838224217295647, 0.02934541366994381, -0.03269951045513153, 0.01476492639631033, -0.01714237406849861, -0.02572629041969776, -0.01909174770116806, -0.04784884303808212, -0.01571594923734665, -0.012896386906504631, 0.02877756580710411, -0.06970272958278656, -0.021151840686798096, 0.052705712616443634, -0.05017576739192009, 0.056925687938928604, -0.058222271502017975, 0.012156371958553791, -0.040371719747781754, -0.06307350099086761, 0.011572815477848053, -0.07594673335552216, -0.07464168220758438, 0.07469292730093002, -0.028247669339179993, 0.04115297645330429, -0.06095056235790253, -0.04440835863351822, 0.013770517893135548, 0.026347868144512177, -0.01034488994628191, 0.020311208441853523, 0.07870509475469589, 0.03028191812336445, -0.011764534749090672, -0.017745785415172577, 0.008747543208301067, -0.0036103955935686827, 0.031262002885341644, 0.05733959749341011, -0.015048244036734104, -0.07435832172632217, -0.02750295214354992, 0.030506588518619537, 0.031594254076480865, 0.01577077805995941, 0.03374812379479408, 0.05443703383207321, -0.044867850840091705, 0.07772684842348099, 0.04662270471453667, -0.006705840118229389, 0.031119506806135178, -0.02829890511929989, 0.003911396022886038, -0.05537641420960426, -0.03011409379541874, 0.018018698319792747, 0.07255025207996368, 0.05959275737404823, 0.07668858766555786, 0.003203445812687278, -0.05315067991614342, -0.009899779222905636, -0.06946475803852081, 0.03899113088846207, -0.015509987249970436, -0.07875018566846848, -0.07778025418519974, 0.00495313061401248, 0.04015296697616577, 0.07413381338119507, -0.07820843905210495, 0.025984542444348335, 0.018808670341968536, 0.027188925072550774, -0.03689321503043175, -0.01717221923172474, -0.008197832852602005, -0.04751957207918167, -0.03157969191670418, 0.07472012937068939, 0.0022632137406617403, -0.05730427801609039, -0.05368908494710922, 0.05329285189509392, 0.073670893907547, 0.041346315294504166, -0.020330125465989113, -0.005533008836209774, 0.004685499239712954, 0.008217810653150082, -0.04519030079245567, 0.02923494391143322, -0.0027775096241384745, 0.05124533176422119, 0.037968073040246964, 0.07243121415376663, 0.01896749436855316, 0.04694738611578941, -0.061695460230112076, 0.003269447013735771, 0.07740431278944016, 0.020590977743268013, 0.0351463221013546, -0.014964226633310318, 0.046181369572877884, -0.005740896333009005, 0.015884997323155403, -0.07451356947422028, -0.03201514109969139, -0.04324108362197876, -0.07898201793432236, -0.05824410170316696, 0.05727137625217438, 0.033103097230196, -0.026215726509690285, -0.05584845691919327, -0.01779138669371605, -0.012377175502479076, -0.052109770476818085, -0.017043964937329292, -0.03868643566966057, -0.0686110407114029, -0.009609339758753777, -0.04362625256180763, 0.03296564146876335, 0.038167696446180344, -0.024578340351581573, -0.02902199886739254, 0.04219764843583107, 0.0002790242724586278, 0.034276384860277176, 0.048866696655750275, -0.026022475212812424, 0.04911598935723305, -0.0005639053415507078, -0.0506715290248394, 0.0045064035803079605, -0.027894826605916023, 0.016844529658555984, 0.012551777064800262, -0.045441508293151855, -0.005599892232567072, 0.0017726494697853923, -0.0364694781601429, -0.022689566016197205, -0.026861874386668205, 0.07441285997629166, -0.004357734229415655, -0.07114717364311218, -0.06317204982042313, -0.07741003483533859, -0.022068265825510025, -0.009244944900274277, 0.006447409279644489, 0.015503124333918095, 0.016868695616722107, 0.07621265947818756, 0.044514283537864685, 0.018835939466953278, 0.037366896867752075, -0.062101319432258606, -0.04666673019528389, 0.03910243511199951, -0.020236846059560776, 0.021141748875379562, -0.035532332956790924, -0.06925558298826218, 0.023131469264626503, 0.038223858922719955, -0.07189703732728958, -0.0759577825665474, -0.0496593713760376, 0.04835902899503708, 0.025548631325364113, 0.053806371986866, -0.008611373603343964, 0.07682932168245316, 0.04368126392364502, -0.006208130624145269, -0.07606536149978638, -0.05948043614625931, 0.029073379933834076, 0.07857917994260788, 0.0636780709028244, -0.07569380104541779, -0.009504674933850765, -0.017927641049027443, 0.051458656787872314, -0.021542981266975403, 0.04191930592060089, 0.07875093817710876, -0.020735982805490494, 0.04082101583480835, -0.00308788288384676, -0.06755795329809189, -0.0602714866399765, 0.014674417674541473, -0.07605843245983124, 0.03314954414963722, -0.011036059819161892, 0.016384361311793327, -0.0050338017754256725, -0.06463664770126343, 0.06643784791231155, 0.01260195579379797, 0.009154423139989376, 0.06689465790987015, 0.017823979258537292, -0.0037177775520831347, 0.010918318293988705, 0.07630182057619095, -0.07018986344337463, -0.01867256686091423, 0.07649163156747818, -0.07286832481622696, 0.041281938552856445, -0.02609127014875412, 0.04578176885843277, 0.0009073994006030262, 0.0064117503352463245, 0.018681535497307777, -0.013643055222928524, 0.047105204313993454, 0.002359493635594845, -0.020388340577483177, 0.01878989487886429, 0.02568501979112625, -0.06962781399488449, -0.010508417151868343, -0.0119458744302392, 0.034421440213918686, -0.061722077429294586, 0.07011823356151581, -0.07702178508043289, 0.06958302855491638, -0.000528452976141125, -0.07454612106084824, -0.060634758323431015},
	}
)

func testComputeDistances(t *testing.T) {
	idx := NewIndex(testIDs, testEmbeddings)
	distances := idx.computeDistances(testEmbeddings[0])

	expectedDistances := Distances{
		{id: "1", distance: 1.0},
		{id: "2", distance: 0.13617581},
		{id: "3", distance: 0.14617065},
		{id: "4", distance: 0.13077903},
		{id: "5", distance: 0.15513653},
	}

	if !reflect.DeepEqual(distances, expectedDistances) {
		t.Errorf("distances %v do not match expected %v", distances, expectedDistances)
	}
}

func testKNN(t *testing.T) {
	idx := NewIndex(testIDs, testEmbeddings)
	{
		// Select kNN over the first embedding, we should retrieve a score of 1
		distances := idx.KNN(testEmbeddings[0], 1)

		if distances[0].id != "1" {
			t.Errorf("expected first id to be 1, got %v", distances)
		}
	}
	{
		// Select kNN over the first embedding, we should retrieve a score of 1
		distances := idx.KNN(testEmbeddings[4], 1)

		if distances[0].id != "5" {
			t.Errorf("expected first id to be 5, got %v", distances)
		}
	}
	{
		// Select kNN over the first embedding, we should retrieve a score of 1
		distances := idx.KNN(testEmbeddings[0], 10)
		expectedDistances := Distances{
			{id: "1", distance: 1.0},
			{id: "5", distance: 0.15513653},
			{id: "3", distance: 0.14617065},
			{id: "2", distance: 0.13617581},
			{id: "4", distance: 0.13077903},
		}
		if !reflect.DeepEqual(distances, expectedDistances) {
			t.Errorf("distances %v do not match expected %v", distances, expectedDistances)
		}
	}
}

func generateEmbedding(d int) []float32 {
	vec := make([]float32, d)
	for i := 0; i < d; i++ {
		vec[i] = float32(rand.NormFloat64())
	}
	return vec
}

func generateIndex(n, d int) *Index {
	vectors := make([][]float32, n)
	ids := make([]string, n)
	for i := 0; i < n; i++ {
		vectors[i] = generateEmbedding(d)
		ids[i] = strconv.Itoa(i + 1)
	}
	return NewIndex(ids, vectors)
}

func BenchmarkKNN_100_768_50(b *testing.B) {
	n, d, k := 100, 768, 50
	idx := generateIndex(n, d)
	centroid := generateEmbedding(d)
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		idx.KNN(centroid, k)
	}
}

func BenchmarkKNN_1000_768_50(b *testing.B) {
	n, d, k := 1000, 768, 50
	idx := generateIndex(n, d)
	centroid := generateEmbedding(d)
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		idx.KNN(centroid, k)
	}
}

func BenchmarkKNN_10000_768_50(b *testing.B) {
	n, d, k := 10000, 768, 50
	idx := generateIndex(n, d)
	centroid := generateEmbedding(d)
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		idx.KNN(centroid, k)
	}
}

func BenchmarkKNN_100000_768_50(b *testing.B) {
	n, d, k := 100000, 768, 50
	idx := generateIndex(n, d)
	centroid := generateEmbedding(d)
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		idx.KNN(centroid, k)
	}
}

func BenchmarkKNN_1000000_768_50(b *testing.B) {
	n, d, k := 1000000, 768, 50
	idx := generateIndex(n, d)
	centroid := generateEmbedding(d)
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		idx.KNN(centroid, k)
	}
}
